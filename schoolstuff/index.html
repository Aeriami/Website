<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Forms</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <img src="kis.gif"> <img src="wes.gif">
    <div class="container">
        <h1>General:</h1>
        <pre class="code-block">
            <code class="python">
import tkinter as tk
from tkinter import ttk, messagebox
import csv

def calculate_cost(costs, age_discounts, condition_discounts, item, age, condition):
    if item not in costs:
        return "Invalid Item"
    age = int(age)
    if age not in age_discounts:
        return "Invalid Age"
    cost = costs[item]
    age_discount = age_discounts[age]
    condition_discount = condition_discounts.get(condition, 0)
    total_cost = cost * (1 - (age_discount + condition_discount) / 100)
    return round(total_cost, 2)  # Round up to 2 decimal places

def save_record(headers, *data):
    with open('history.csv', mode='a', newline='') as file:
        writer = csv.writer(file)
        if file.tell() == 0:
            writer.writerow(headers)
        writer.writerow(data)

def on_submit(costs, age_discounts, condition_discounts, entry_data, total_cost_label):
    name = entry_data[0].get()
    item = entry_data[1].get()
    age = entry_data[2].get()
    condition = entry_data[3].get()

    cost = calculate_cost(costs, age_discounts, condition_discounts, item, age, condition)

    if isinstance(cost, str):
        messagebox.showerror("Error", cost)
    else:
        total_cost_label.config(text=f"Total Cost: ${cost:.2f}")
        save_record(headers, *entry_data, cost)
        messagebox.showinfo("Success", "Order submitted successfully.")

def create_order_form(headers, costs, age_discounts, condition_discounts, name_options, item_options, age_options, condition_options):
    root = tk.Tk()
    root.title("Order Form")

    entry_data = []
    for i, header in enumerate(headers):
        tk.Label(root, text=f"{header}:").grid(row=i, column=0, padx=10, pady=5)
        if header == "Name":
            entry = ttk.Combobox(root, values=name_options)
        elif header == "Item":
            entry = ttk.Combobox(root, values=item_options)
        elif header == "Age":
            entry = ttk.Combobox(root, values=age_options)
        elif header == "Condition":
            entry = ttk.Combobox(root, values=condition_options)
        else:
            entry = ttk.Entry(root)
        entry.grid(row=i, column=1, padx=10, pady=5)
        entry_data.append(entry)

    submit_button = ttk.Button(root, text="Submit", command=lambda: on_submit(costs, age_discounts, condition_discounts, entry_data, total_cost_label))
    submit_button.grid(row=len(headers), column=0, columnspan=2, pady=10)

    total_cost_label = tk.Label(root, text="Total Cost: $0.00")
    total_cost_label.grid(row=len(headers)+1, column=0, columnspan=2, pady=5)

    root.mainloop()

# Example customization
headers = ["Name", "Item", "Age", "Condition"]
costs = {
    "Item 1": 10.00,
    "Item 2": 20.00,
    "Item 3": 15.00
}
age_discounts = {
    1: 10,
    2: 20,
    3: 30,
    4: 40
}
condition_discounts = {
    "New": 0,
    "Used": 5
}
name_options = ["John", "Jane", "Bob"]
item_options = list(costs.keys())
age_options = [str(age) for age in age_discounts.keys()]
condition_options = list(condition_discounts.keys())

create_order_form(headers, costs, age_discounts, condition_discounts, name_options, item_options, age_options, condition_options)
            </code>
        </pre>

        <h1>Iesa's one:</h1>
        <pre class="code-block">
            <code class="python">
import tkinter as tk
from tkinter import ttk
import csv
import os

def submit_name_age():
    process_order(show_result=False)

def show_order():
    process_order(show_result=True)

def process_order(show_result):
    # Get the name, date, selected textbook, and age from the UI
    name = name_entry.get()
    date = date_entry.get()
    selected_textbook = option_combobox.get()
    selected_age = textbook_age.get()

    # Validate date format
    try:
        int(date.replace("/", ""))  # Convert date to integer to check if it's a valid number
    except ValueError:
        result_label.config(text="Please enter a valid date.")
        return

    # Calculate the textbook cost
    try:
        total_cost = calculate_textbook_cost(name, date, selected_textbook, int(selected_age), "Slightly damaged")
        if isinstance(total_cost, str):
            result_label.config(text=total_cost)
            return
    except Exception as e:
        result_label.config(text=str(e))
        return

    if show_result:
        # Display order details in the Listbox
        order_details_listbox.delete(0, tk.END)
        order_details_listbox.insert(tk.END, f"Name: {name}")
        order_details_listbox.insert(tk.END, f"Date: {date}")
        order_details_listbox.insert(tk.END, f"Textbook: {selected_textbook}")
        order_details_listbox.insert(tk.END, f"Age: {selected_age}")
        order_details_listbox.insert(tk.END, f"Total Cost: ${total_cost:.2f}")
    else:
        # Append data to CSV
        with open('NameAge.csv', mode='a', newline='') as file:
            writer = csv.writer(file)
            writer.writerow([name, date, selected_textbook, selected_age, total_cost])
        result_label.config(text=f"Order for {name} added: {selected_textbook}, Age {selected_age}, Cost: ${total_cost:.2f}")

    # Clear input fields
    name_entry.delete(0, tk.END)
    date_entry.delete(0, tk.END)

def show_directory():
    directory_label.config(text=f"CSV will be saved in: {os.getcwd()}")

def calculate_textbook_cost(StudentName, OrderDate, TextbookName, TextBookAge, TextBookType):
    textbook_prices = {
        "Applied Computing": 86.00,
        "Data Analytics": 90.95,
        "Software Development": 92.00,
        "Vic Farrell Software Development": 59.99
    }
    cost = textbook_prices.get(TextbookName, "Textbook not found.")
    if isinstance(cost, str):
        return cost

    age_discounts = [0, 0.1, 0.2, 0.3, 0.4]
    TextBookAgeDiscount = cost * age_discounts[TextBookAge]

    TextbookTypeDiscount = 0
    if TextBookType == "Slightly damaged":
        TextbookTypeDiscount = cost * 0.1

    TotalCost = cost - TextBookAgeDiscount - TextbookTypeDiscount
    return TotalCost

# Create main window
root = tk.Tk()
root.title("Tech Old Textbookly")
root.geometry("600x600")  # Increased height to accommodate new Listbox

# GUI elements
title_label = tk.Label(root, text="Tech Old Textbookly", font=("Arial", 25))
title_label.grid(row=0, column=1, columnspan=10)

name_label = tk.Label(root, text="Name:")
name_label.grid(row=1, column=0, pady=7)
name_entry = tk.Entry(root)
name_entry.grid(row=1, column=1, pady=7)

date_label = tk.Label(root, text="Order Date:")
date_label.grid(row=2, column=0)
date_entry = tk.Entry(root)
date_entry.grid(row=2, column=1)

textbook_label = tk.Label(root, text="Textbook")
textbook_label.grid(row=3, column=0, pady=10)
options = ['Applied Computing', 'Data Analytics', 'Software Development', 'Vic Farrell Software Development']
option_combobox = ttk.Combobox(root, values=options, state="readonly")
option_combobox.grid(row=3, column=1, pady=10)
option_combobox.current(0)

age_label = tk.Label(root, text="Textbook Age")
age_label.grid(row=4, column=0)
textbook_age = tk.IntVar()
textbook_age.set(1)
ages = [1, 2, 3, 4]
select_label = tk.Label(root, text="Select Textbook Age")
select_label.grid(row=4, column=1, padx=(40, 0))

# Radio buttons with reduced padding
for i, age in enumerate(ages, start=1):
    rb = ttk.Radiobutton(root, text=str(age), value=age, variable=textbook_age)
    rb.grid(row=5, column=i)

submit_button = ttk.Button(root, text="Book order",command=submit_name_age, width=15)
submit_button.grid(row=8, column=0)

show_order_button = ttk.Button(root, text="Calculate Order", command=show_order, width=15)
show_order_button.grid(row=7, column=0)

directory_label = tk.Label(root, text="")
directory_label.grid(row=10, column=1, columnspan=20)

directory_button = ttk.Button(root, text="Show Save Location", command=show_directory)
directory_button.grid(row=10, column=0)

# Listbox to display order details
order_details_listbox = tk.Listbox(root, height=6, width=27)
order_details_listbox.place(x=130, y=220)

# Start the application
root.mainloop()
            </code>
        </pre>
    </div>

    <h1>Iesa's python for xml:</h1>
        <pre class="code-block">
            <code class="python">
                import tkinter as tk
                from tkinter import ttk
                from tkinter.messagebox import showinfo
                import xml.etree.ElementTree as ET
                
                
                def show_info():
                    info_text.config(state='normal')
                    info_text.delete('1.0', tk.END)  # Clear previous text
                    # Read information from XML file
                    tree = ET.parse('Laptop.xml')
                    root = tree.getroot()
                
                    # Check which laptop is selected
                    if selected_laptop.get() == 'Value 1':
                        laptop_index = 0
                    elif selected_laptop.get() == 'Value 2':
                        laptop_index = 1
                    elif selected_laptop.get() == 'Value 3':
                        laptop_index = 2
                    else:
                        return
                
                    # Display information for the selected laptop
                    laptop = root[laptop_index]
                    for child in laptop:
                        info_text.insert(tk.END, f"- {child.tag}: {child.text}\n")
                    info_text.config(state='disabled')
                
                
                def add_to_cart():
                    # Read information from XML file
                    tree = ET.parse('Laptop.xml')
                    root = tree.getroot()
                
                    # Check which laptop is selected
                    if selected_laptop.get() == 'Value 1':
                        laptop_index = 0
                    elif selected_laptop.get() == 'Value 2':
                        laptop_index = 1
                    elif selected_laptop.get() == 'Value 3':
                        laptop_index = 2
                    else:
                        return
                
                    # Get laptop information
                    laptop = root[laptop_index]
                    name = laptop.find('Name').text
                    price = float(laptop.find('Price').text.split('$')[1])  # Adjusted to handle space before price
                
                    # Add laptop information to cart
                    cart_listbox.insert(tk.END, f"{name}: ${price:.2f}")  # Format price with two decimal places
                
                    # Update total cost
                    update_total_price()
                
                
                def update_total_price():
                    total_price_entry.config(state='normal')  # Enable the entry
                    total_price_entry.delete(0, tk.END)  # Clear previous value
                
                    total = sum(float(item.split(':')[1].strip().strip('$')) for item in cart_listbox.get(0, tk.END))
                    total_price_entry.insert(tk.END, f"${total:.2f}")  # Insert the total price
                    total_price_entry.config(state='readonly')  # Make the entry read-only again
                
                
                def open_cart():
                    cart_window = tk.Toplevel(window)
                    cart_window.title("Cart")
                
                    # Label for cart items
                    cart_items_label = tk.Label(cart_window, text="The following items are currently in your cart:")
                    cart_items_label.pack(padx=10, pady=10)
                
                    global cart_listbox
                    cart_listbox = tk.Listbox(cart_window)
                    cart_listbox.pack(fill=tk.BOTH, expand=True, padx=8, pady=(0, 10))
                
                    # Close Cart button
                    close_cart_button = ttk.Button(cart_window, text="Close Cart", command=cart_window.destroy)
                    close_cart_button.pack(side=tk.BOTTOM, padx=10, pady=10)
                
                    # Total text
                    total_text_label = tk.Label(cart_window, text="Total: ")
                    total_text_label.pack(side=tk.LEFT, padx=10, pady=(0, 5))
                
                    # Total price entry
                    global total_price_entry
                    total_price_entry = tk.Entry(cart_window, width=10, state='readonly')
                    total_price_entry.pack(side=tk.LEFT, padx=10, pady=(0, 5))
                
                
                window = tk.Tk()
                window.title("Recommended BYOD Laptops")
                
                frame = tk.Frame(window)
                frame.pack(fill=tk.BOTH, expand=True)
                
                # Saving User Info
                user_info_frame = tk.LabelFrame(frame, text="Please start by entering your name and form class.")
                user_info_frame.pack(fill=tk.BOTH, padx=20, pady=20)
                
                name_label = tk.Label(user_info_frame, text="Name:")
                name_label.grid(row=1, column=0)
                phone_label = tk.Label(user_info_frame, text="Phone:")
                phone_label.grid(row=1, column=2)
                class_lable = tk.Label(user_info_frame, text="Form Class:")
                class_lable.grid(row=2, column=0)
                email_lable = tk.Label(user_info_frame, text="Email:")
                email_lable.grid(row=2, column=2)
                
                name_entry = tk.Entry(user_info_frame)
                phone_entry = tk.Entry(user_info_frame)
                class_entry = tk.Entry(user_info_frame)
                email_entry = tk.Entry(user_info_frame)
                name_entry.grid(row=1, column=1)
                phone_entry.grid(row=1, column=3)
                class_entry.grid(row=2, column=1)
                email_entry.grid(row=2, column=3)
                
                selected_laptop = tk.StringVar()
                laptop_label = tk.Label(user_info_frame, text="Which Computer are you Interested in?")
                laptop_label.grid(row=3, column=0)
                
                laptop1_check = ttk.Radiobutton(user_info_frame, text="Lenovo ThinkPad 11e 5th Gen", value='Value 1',
                                                variable=selected_laptop)
                laptop2_check = ttk.Radiobutton(user_info_frame, text="Apple MacBook Air 13'            ", value='Value 2',
                                                variable=selected_laptop)
                laptop3_check = ttk.Radiobutton(user_info_frame, text="Asus Zephyrus G1414     ", value='Value 3',
                                                variable=selected_laptop)
                laptop1_check.grid(row=4, column=0, sticky="w")
                laptop2_check.grid(row=5, column=0, sticky="w")
                laptop3_check.grid(row=6, column=0, sticky="w")
                
                info_button = ttk.Button(user_info_frame, text="See Information", command=show_info)
                info_button.grid(row=7, column=0, pady=5)
                
                info_text = tk.Text(user_info_frame, height=10, width=45, state='disabled')
                info_text.grid(row=8, column=0, columnspan=5)
                
                # Button Frame
                button_frame = tk.Frame(frame)
                button_frame.pack(fill=tk.BOTH, padx=20, pady=10)
                
                add_to_cart_button = ttk.Button(button_frame, text="Add to Cart", command=add_to_cart)
                add_to_cart_button.pack(side=tk.LEFT, padx=10)
                
                go_to_cart_button = ttk.Button(button_frame, text="Go to Cart", command=open_cart)
                go_to_cart_button.pack(side=tk.LEFT, padx=5)
                
                window.mainloop()
            </code>
        </pre>
    </div>


    <h1>Iesa's python for xml:</h1>
        <pre class="code-block">
            <code class="XML">
                <data date="2024-04-01">
                    <Laptop>
                       <Name>Lenovo ThinkPad 11e 5th Gen</Name>
                       <Processor>N4120 processor</Processor>
                       <Storage>128GB</Storage>
                       <Memory>4GB</Memory>
                       <Price>$571.45</Price>
                    </Laptop>
                    <Laptop>
                       <Name>Apple MacBookAir 13" -Silver</Name>
                       <Processor>A11 8-Core</Processor>
                       <Storage>256GB</Storage>
                       <Memory>8GB</Memory>
                       <Price>$1347.72</Price>
                    </Laptop>
                    <Laptop>
                       <Name>Asus Zephyrus G1414" Full HD 144Hz</Name>
                       <Processor>AMD Ryzen 9</Processor>
                       <Storage>512GB</Storage>
                       <Memory>12GB</Memory>
                       <Price>$2798.00</Price>
                    </Laptop>
                    </data>
            </code>
        </pre>
    </div>
</body>
</html>
